import{i as ie,u as te,k as ne,j as e,M as m,G as oe,U as le,D as se,l as O,m as ae,a as de}from"./prerender-BIIx8aII.js";import{u as re,R as l}from"./vendor-BsMbSbDn.js";const w="abhijeetsridhar14@gmail.com",ce=Array.from({length:de},(R,d)=>d+1);function ue({isOpen:R,onRequestClose:d}){const E=re(),{message:_,setTimedMessage:s}=ie(""),{user:o,friends:f,friendRequests:b,acceptFriendRequest:U,declineFriendRequest:$,removeFriend:H,isVerifiedUser:L,sendChallenge:V,sendFriendRequestByIdentifier:q}=te(),Y=ne(null,!0,!1),[y,K]=l.useState(null),[j,z]=l.useState(1),[p,F]=l.useState("standard"),[M,X]=l.useState(2),[A,B]=l.useState(!1),[J,v]=l.useState(!1),[G,I]=l.useState(""),[g,W]=l.useState(!1),[u,S]=l.useState(null),[C,P]=l.useState(!1),[r,h]=l.useState(null),[x,T]=l.useState("1m"),[n,k]=l.useState(!1),Q=()=>{const i="/better-wordle/",a=i.endsWith("/")?i.slice(0,-1):i;return`${window.location.origin}${a}`},D=async()=>{var a;if(!r||!(o!=null&&o.uid))return;const i=o.email===w;k(!0);try{if(i)await O()({recipientUid:r.id,duration:x}),s(`Premium granted to ${r.name}.`,4e3),h(null);else{const c=await ae()({recipientUid:r.id,baseUrl:Q(),duration:x}),N=(a=c==null?void 0:c.data)==null?void 0:a.url;if(N){window.location.assign(N);return}s("Could not start gift checkout.",5e3)}}catch(t){let c=(t==null?void 0:t.message)||(t!=null&&t.code?`Error: ${t.code}`:"Could not complete gift.");((t==null?void 0:t.code)==="functions/internal"||(t==null?void 0:t.code)==="internal")&&(c="Gift checkout is unavailable. If you're setting this up, deploy the latest Cloud Functions and set STRIPE_GIFT_PRICE_ID_* and STRIPE_SECRET_KEY (see gift-subs.md)."),s(c,7e3)}finally{k(!1)}},Z=async()=>{if(!(!(o!=null&&o.uid)||o.email!==w)){k(!0);try{await O()({recipientUid:o.uid,duration:x}),s("Premium granted to you.",4e3),h(null)}catch(i){const a=(i==null?void 0:i.message)||(i!=null&&i.code?`Error: ${i.code}`:"Could not grant premium.");s(a,7e3)}finally{k(!1)}}};if(!L)return e.jsx(m,{isOpen:R,onRequestClose:d,children:e.jsxs("div",{className:"friendsModalRoot",children:[e.jsx("h2",{style:{margin:"0 0 16px 0",fontSize:"22px",fontWeight:"bold"},children:"Verify your account"}),e.jsx("p",{style:{marginBottom:"16px",color:"#d7dadc",fontSize:"14px"},children:"Friends are only available for verified accounts. Please verify your email or sign in with Google to use this feature."}),e.jsx("button",{onClick:d,className:"friendsModalPrimaryButton",children:"Close"})]})});const ee=async i=>{i.preventDefault();const a=G.trim();if(!a){s("Please enter an email or username.",4e3);return}try{W(!0),await q(a),s("Friend request sent.",3e3),I("")}catch(t){s((t==null?void 0:t.message)||"Failed to send friend request.",5e3)}finally{W(!1)}};return e.jsxs(m,{isOpen:R,onRequestClose:d,children:[e.jsx(oe,{message:_}),e.jsxs("div",{className:"friendsModalRoot",children:[e.jsx("h2",{style:{margin:"0 0 24px 0",fontSize:"24px",fontWeight:"bold"},children:"Friends & Requests"}),e.jsxs("form",{onSubmit:ee,style:{marginBottom:"20px",textAlign:"left"},children:[e.jsx("label",{style:{display:"block",marginBottom:"6px",fontSize:"13px",color:"#d7dadc"},children:"Add friend by email or username"}),e.jsxs("div",{style:{display:"flex",gap:"8px"},children:[e.jsx("input",{type:"text",placeholder:"friend@example.com or username",value:G,onChange:i=>I(i.target.value),disabled:g,style:{flex:1,padding:"8px 10px",borderRadius:6,border:"1px solid #3A3A3C",background:"#212121",color:"#ffffff",fontSize:13}}),e.jsx("button",{type:"submit",disabled:g,style:{padding:"8px 12px",borderRadius:6,border:"none",background:"#e56b6f",color:"#ffffff",fontWeight:"bold",fontSize:12,cursor:g?"not-allowed":"pointer",opacity:g?.8:1},children:g?"Sending...":"Send request"})]})]}),b&&b.length>0&&e.jsxs("div",{style:{marginBottom:"24px"},children:[e.jsxs("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"bold",color:"#d7dadc",textAlign:"left"},children:["Friend Requests (",b.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"10px",marginBottom:"16px",borderBottom:"1px solid #3A3A3C",paddingBottom:"16px"},children:b.map(i=>e.jsxs("div",{style:{padding:"12px 14px",background:"#372F41",borderRadius:"8px",border:"1px solid #50a339",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"10px"},children:[e.jsxs("div",{style:{textAlign:"left",flex:1},children:[e.jsx("span",{style:{color:"#ffffff",fontWeight:"600"},children:i.fromName}),e.jsx("div",{style:{color:"#818384",fontSize:"11px",marginTop:"2px"},children:"wants to be friends"})]}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[e.jsx("button",{onClick:()=>U(i.id,i.fromName),style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#e56b6f",color:"#ffffff",fontWeight:"bold",fontSize:"11px",cursor:"pointer"},children:"Accept"}),e.jsx("button",{onClick:()=>$(i.id),style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #3A3A3C",background:"#355070",color:"#ffffff",fontWeight:"bold",fontSize:"11px",cursor:"pointer"},children:"Decline"})]})]},i.id))})]}),e.jsxs("div",{children:[e.jsxs("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"bold",color:"#d7dadc",textAlign:"left"},children:["Friends (",(f==null?void 0:f.length)||0,")"]}),f&&f.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"12px",maxHeight:"300px",overflowY:"auto",marginBottom:"20px"},children:f.map(i=>e.jsxs("div",{style:{padding:"14px 16px",background:"#372F41",borderRadius:"8px",border:"1px solid #3A3A3C",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"8px"},children:[e.jsx(le,{userId:i.id,username:i.name,size:"sm"}),e.jsxs("div",{style:{display:"flex",gap:"6px"},children:[e.jsx("button",{onClick:()=>{h(i),T("1m")},style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #50a339",background:"transparent",color:"#50a339",fontWeight:"bold",fontSize:"11px",cursor:"pointer"},children:"Gift"}),e.jsx("button",{onClick:()=>{K(i),z(1),F("standard"),v(!0)},style:{padding:"6px 10px",borderRadius:"6px",border:"none",background:"#e56b6f",color:"#ffffff",fontWeight:"bold",fontSize:"11px",cursor:"pointer"},children:"Challenge"}),e.jsx("button",{onClick:()=>S(i),style:{padding:"6px 10px",borderRadius:"6px",border:"1px solid #3A3A3C",background:"#355070",color:"#ffffff",fontWeight:"bold",fontSize:"11px",cursor:"pointer"},children:"Remove"})]})]},i.id))}):e.jsx("div",{style:{padding:"32px 16px",color:"#818384",fontSize:"14px",marginBottom:"20px"},children:"No friends yet. Send friend requests while playing Multiplayer Mode!"})]}),e.jsx("button",{onClick:d,className:"friendsModalPrimaryButton",children:"Close"})]}),e.jsx(m,{isOpen:!!r,onRequestClose:()=>{n||h(null)},children:r&&e.jsxs("div",{style:{backgroundColor:"#372F41",borderRadius:16,padding:32,maxWidth:480,width:"92vw",textAlign:"center",boxShadow:"0 20px 60px rgba(0,0,0,0.8)"},children:[e.jsxs("h2",{style:{margin:0,marginBottom:16,fontSize:24,fontWeight:"bold",color:"#ffffff",letterSpacing:1},children:["Gift Premium to ",r.name]}),e.jsx("div",{style:{marginBottom:20,fontSize:16,color:"#d7dadc",lineHeight:1.6},children:"Choose duration:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8,marginBottom:24},children:se.map(i=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:12,padding:"10px 14px",backgroundColor:x===i.value?"#6d597a":"#372F41",borderRadius:8,border:x===i.value?"2px solid #50a339":"1px solid #3A3A3C",cursor:"pointer"},children:[e.jsx("input",{type:"radio",name:"gift-duration",value:i.value,checked:x===i.value,onChange:()=>T(i.value),style:{cursor:"pointer"}}),e.jsx("span",{style:{flex:1,color:"#ffffff",fontWeight:500},children:i.label}),e.jsxs("span",{style:{color:"#50a339",fontWeight:"bold"},children:["$",i.pricePerMonth,"/month",i.savings&&e.jsxs("span",{style:{marginLeft:6,fontSize:12,color:"#818384"},children:["(save ",i.savings,")"]})]})]},i.value))}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(o==null?void 0:o.email)===w?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:D,disabled:n,style:{width:"100%",padding:"14px 0",borderRadius:10,border:"none",background:n?"#818384":"#e56b6f",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:n?"not-allowed":"pointer",letterSpacing:1,textTransform:"uppercase"},children:n?"...":`Gift to ${r.name}`}),e.jsx("button",{onClick:Z,disabled:n,style:{width:"100%",padding:"12px 0",borderRadius:10,border:"1px solid #50a339",background:"transparent",color:"#50a339",fontSize:14,fontWeight:"bold",cursor:n?"not-allowed":"pointer"},children:"Grant myself premium"})]}):e.jsx("button",{onClick:D,disabled:n,style:{width:"100%",padding:"14px 0",borderRadius:10,border:"none",background:n?"#818384":"#e56b6f",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:n?"not-allowed":"pointer",letterSpacing:1,textTransform:"uppercase"},children:n?"...":"Continue to payment"}),e.jsx("button",{onClick:()=>{n||h(null)},disabled:n,style:{width:"100%",padding:"12px 0",borderRadius:10,border:"1px solid #3A3A3C",background:"transparent",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:n?"not-allowed":"pointer"},children:"Cancel"})]})]})}),e.jsx(m,{isOpen:J&&!!y,onRequestClose:()=>v(!1),children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("h2",{style:{margin:0,marginBottom:"24px",fontSize:20,fontWeight:"bold",color:"#ffffff"},children:"Multiplayer Game Configuration"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",color:"#d7dadc",fontSize:14},children:"Number of Boards"}),e.jsx("select",{value:j,onChange:i=>z(parseInt(i.target.value,10)),style:{width:"100%",padding:"10px",borderRadius:6,border:"1px solid #3A3A3C",background:"#372F41",color:"#ffffff",fontSize:14,cursor:"pointer"},children:ce.map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"challenge-variant-select",style:{display:"block",marginBottom:"8px",color:"#d7dadc",fontSize:14},children:"Game Variant"}),e.jsxs("select",{id:"challenge-variant-select",value:p,onChange:i=>F(i.target.value),style:{width:"100%",padding:"10px",borderRadius:6,border:"1px solid #3A3A3C",background:"#372F41",color:"#ffffff",fontSize:14,cursor:"pointer"},children:[e.jsx("option",{value:"standard",children:"Standard (6 guesses)"}),e.jsx("option",{value:"speedrun",children:"Speedrun (Unlimited guesses, timed)"}),e.jsx("option",{value:"solutionhunt",children:"Solution Hunt (See possible words)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginTop:"12px",marginBottom:"8px",color:"#d7dadc",fontSize:14},children:"Max players in room"}),e.jsx("select",{value:M,onChange:i=>X(parseInt(i.target.value,10)||2),style:{width:"100%",padding:"10px",borderRadius:6,border:"1px solid #3A3A3C",background:"#372F41",color:"#ffffff",fontSize:14,cursor:"pointer"},children:[2,3,4,5,6,7,8].map(i=>e.jsx("option",{value:i,children:i},i))})]}),e.jsxs("div",{style:{marginTop:"4px"},children:[e.jsx("div",{style:{display:"block",marginBottom:"6px",color:"#d7dadc",fontSize:14},children:"Room visibility"}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:13,color:"#d7dadc"},children:[e.jsx("input",{type:"radio",name:"challenge-visibility",checked:A,onChange:()=>B(!0),style:{cursor:"pointer"}}),"Public (show in Open Rooms)"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"6px",fontSize:13,color:"#d7dadc"},children:[e.jsx("input",{type:"radio",name:"challenge-visibility",checked:!A,onChange:()=>B(!1),style:{cursor:"pointer"}}),"Private (invite only)"]})]})]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"12px"},children:[e.jsx("button",{onClick:()=>v(!1),style:{flex:1,padding:"12px",borderRadius:8,border:"1px solid #3A3A3C",background:"#355070",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(!(!y||!o))try{const i=Math.max(2,Math.min(8,M)),t=(await Y.createGame({variant:p,speedrun:p==="speedrun",solutionHunt:p==="solutionhunt",maxPlayers:i,isPublic:A,boards:j,challengeOnly:!0})).code;if(!await V(y.id,y.name,t,j,p)){s("A challenge between you and this friend is already pending. Please accept or dismiss it before sending another.",5e3);return}v(!1),d==null||d(),E(`/game?mode=multiplayer&code=${t}&host=true&variant=${p}&boards=${j}`)}catch(i){s((i==null?void 0:i.message)||"Failed to create challenge",5e3)}},style:{flex:1,padding:"12px",borderRadius:8,border:"none",background:"#e56b6f",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:"pointer"},children:"Challenge"})]})]})]})}),e.jsx(m,{isOpen:!!u,onRequestClose:()=>S(null),children:e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("h2",{style:{margin:0,marginBottom:"24px",fontSize:20,fontWeight:"bold",color:"#ffffff"},children:"Remove friend?"}),e.jsxs("p",{style:{margin:0,marginBottom:"12px",color:"#d7dadc",fontSize:14},children:["Are you sure you want to remove ",u==null?void 0:u.name," from your friends list? They will be removed from your list on both sides."]}),e.jsxs("div",{style:{display:"flex",gap:"12px",marginTop:"12px"},children:[e.jsx("button",{onClick:()=>S(null),style:{flex:1,padding:"12px",borderRadius:8,border:"1px solid #3A3A3C",background:"#355070",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:"pointer"},children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(u){P(!0);try{await H(u.id),S(null)}catch(i){s((i==null?void 0:i.message)||"Failed to remove friend.",5e3)}finally{P(!1)}}},disabled:C,style:{flex:1,padding:"12px",borderRadius:8,border:"none",background:"#e56b6f",color:"#ffffff",fontSize:14,fontWeight:"bold",cursor:C?"not-allowed":"pointer",opacity:C?.8:1},children:C?"Removing...":"Remove"})]})]})})]})}export{ue as default};